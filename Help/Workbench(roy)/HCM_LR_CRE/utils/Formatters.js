/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.require("sap.ca.ui.model.format.NumberFormat");jQuery.sap.require("sap.ca.ui.model.format.DateFormat");jQuery.sap.declare("hcm.emp.myleaverequests.utils.Formatters");hcm.emp.myleaverequests.utils.Formatters=(function(){return{init:function(r){this.resourceBundle=r},getDate:function(v){var d;if(v instanceof Date){d=v}else{if(typeof v!='string'&&!(v instanceof String))return null;if(v.length<8)return null;if(v.substring(0,6)!="/Date("||v.substring(v.length-2,v.length)!=")/"){return null}var a=v.substring(6,6+v.length-8);d=new Date();d.setTime(a*1)}return d},stripDecimals:function(n){while(n.length>0&&n.charAt(0)=="0"){n=n.substring(1,1+n.length-1)}var p=n.indexOf(".");if(p<0){if(n.length<1)return"0";return n}while(n.charAt(n.length-1)=="0"){n=n.substring(0,n.length-1)}if(n.charAt(n.length-1)=="."){n=n.substring(0,n.length-1)}if(n.length<1)return"0";if(n.length>0&&n.charAt(0)=="."){return"0"+n}return n},adjustSeparator:function(n){try{if(!isNaN(parseFloat(n))&&isFinite(n)){var a=sap.ca.ui.model.format.NumberFormat.getInstance();if(n.indexOf(".")>0)a.oFormatOptions.decimals=2;return a.format(n)}}catch(e){}return""},DATE_ODATA_MMMyyyy:function(v){var d=hcm.emp.myleaverequests.utils.Formatters.getDate(v);if(d!=null){var D=sap.ca.ui.model.format.DateFormat.getInstance({pattern:"MMM yyyy"});return D.format(d,true)}else{return null}},DATE_ODATA_EEEdMMMyyyy:function(v,s){var d=hcm.emp.myleaverequests.utils.Formatters.getDate(v);if(d!=null){if(s){var D=sap.ca.ui.model.format.DateFormat.getInstance({style:s});return D.format(d,true)}else{if(jQuery.device.is.phone===true){var D=sap.ca.ui.model.format.DateFormat.getInstance({style:"medium"});return D.format(d,true)}else{var D=sap.ca.ui.model.format.DateFormat.getInstance({style:"medium"});return D.format(d,true)}}}else{return null}},DATE_ODATA_EEEdMMMyyyyLong:function(v,s){var d=hcm.emp.myleaverequests.utils.Formatters.getDate(v);if(d!=null){if(s){var D=sap.ca.ui.model.format.DateFormat.getInstance({style:s});return D.format(d,true)}else{if(jQuery.device.is.phone===true){var D=sap.ca.ui.model.format.DateFormat.getInstance({style:"long"});return D.format(d,true)}else{var D=sap.ca.ui.model.format.DateFormat.getInstance({style:"full"});return D.format(d,true)}}}else{return null}},DATE_ODATA_ddMMMyyyy:function(v){var d=hcm.emp.myleaverequests.utils.Formatters.getDate(v);if(d!=null){var D=sap.ca.ui.model.format.DateFormat.getInstance({pattern:"dd.MM.yyyy"});return D.format(d,true)}else{return null}},DATE_YYYYMMdd:function(d){if(d==undefined)return"";var D=sap.ca.ui.model.format.DateFormat.getInstance({pattern:"YYYY-MM-dd"});return D.format(d)},BALANCE:function(v){if(v==undefined)return"";if(typeof v!='string'&&!(v instanceof String))return"";return hcm.emp.myleaverequests.utils.Formatters.adjustSeparator(hcm.emp.myleaverequests.utils.Formatters.stripDecimals(v))},DURATION_FORMAT:function(h){if(h.indexOf(".")>-1){var d=h.split(".");var a=d[0].toString();if(parseInt(d[1])<10)d[1]=parseInt(d[1])*10;var m=(parseInt(d[1])*60)/100;m=Math.round(m);m=m.toString();if(m<10)m="0"+m;return a+":"+m}else return h+":00"},DURATION:function(d,h){if(d==undefined||h==undefined)return"";d=hcm.emp.myleaverequests.utils.Formatters.stripDecimals(d);var p=d.indexOf(".");if(p<0)return hcm.emp.myleaverequests.utils.Formatters.adjustSeparator(d);return hcm.emp.myleaverequests.utils.Formatters.DURATION_FORMAT(hcm.emp.myleaverequests.utils.Formatters.stripDecimals(h))},DURATION_UNIT:function(d,h){if(d==undefined||h==undefined)return"";d=hcm.emp.myleaverequests.utils.Formatters.stripDecimals(d);var p=d.indexOf(".");if(p<0)return(d*1!=1)?hcm.emp.myleaverequests.utils.Formatters.resourceBundle.getText("LR_DAYS"):hcm.emp.myleaverequests.utils.Formatters.resourceBundle.getText("LR_DAY");return(h*1!=1)?hcm.emp.myleaverequests.utils.Formatters.resourceBundle.getText("LR_HOURS"):hcm.emp.myleaverequests.utils.Formatters.resourceBundle.getText("LR_HOUR")},isHalfDayLeave:function(d){if(d==undefined)return false;d=hcm.emp.myleaverequests.utils.Formatters.stripDecimals(d);var p=d.indexOf(".");if(p<0)return false;return true},TIME_hhmm:function(v){if(v==undefined)return"";var d;if(v instanceof Date){d=v}else if(v.ms){var h=(v.ms/(3600*1000))|0;var m=((v.ms-(h*3600*1000))/(60*1000))|0;var s=((v.ms-(h*3600*1000)-(m*60*1000))/1000)|0;d=new Date();d.setHours(h,m,s,0)}else{if(typeof v!='string'&&!(v instanceof String))return"";if(v.length!=11)return"";if(v.substring(0,2)!="PT"||v.substring(4,5)!="H"||v.substring(7,8)!="M"||v.substring(10,11)!="S"){return""}var h=v.substring(2,4)*1;var m=v.substring(5,7)*1;var s=v.substring(8,10)*1;d=new Date();d.setHours(h,m,s,0)}var D=sap.ca.ui.model.format.DateFormat.getTimeInstance({style:"short"});var t=D.format(d);var T=t.split(":");var a="";var l=T[T.length-1];if(isNaN(l)){var A=l.split(" ");T[T.length-1]=A[0];a=" "+A[1]}return(T[0]+":"+T[1]+a)},FORMAT_DATETIME:function(p,v){return p+" "+hcm.emp.myleaverequests.utils.Formatters.DATE_ODATA_EEEdMMMyyyy(v)},FORMATTER_INTRO:function(r){if(!r||r.length<1){return""}var l=r[0].LeaveRequestType;var s=r[0].StatusCode;if(l=="2"){if(s=="SENT"){return hcm.emp.myleaverequests.utils.Formatters.resourceBundle.getText("LR_CHANGE_PENDING")}if(s=="APPROVED"){return hcm.emp.myleaverequests.utils.Formatters.resourceBundle.getText("LR_CHANGE_DONE")}}if(l=="3"){if(s=="SENT"){return hcm.emp.myleaverequests.utils.Formatters.resourceBundle.getText("LR_CANCEL_PENDING")}if(s=="APPROVED"){return hcm.emp.myleaverequests.utils.Formatters.resourceBundle.getText("LR_CANCEL_DONE")}}return""},FORMAT_ENDDATE:function(h,w,s,E,a){try{if(h&&w&&s&&E&&a){if(hcm.emp.myleaverequests.utils.Formatters.isHalfDayLeave(w)){return hcm.emp.myleaverequests.utils.Formatters.TIME_hhmm(s)+" "+h+" "+hcm.emp.myleaverequests.utils.Formatters.TIME_hhmm(a)}else if(w*1!=1){return h+" "+hcm.emp.myleaverequests.utils.Formatters.DATE_ODATA_EEEdMMMyyyy(E)}}}catch(e){}return""},FORMAT_ENDDATE_LONG:function(h,w,s,E,a){try{if(h&&w&&s&&E&&a){if(hcm.emp.myleaverequests.utils.Formatters.isHalfDayLeave(w)){return hcm.emp.myleaverequests.utils.Formatters.TIME_hhmm(s)+" "+h+" "+hcm.emp.myleaverequests.utils.Formatters.TIME_hhmm(a)}else if(w*1!=1){return h+" "+hcm.emp.myleaverequests.utils.Formatters.DATE_ODATA_EEEdMMMyyyyLong(E)}}}catch(e){}return""},SET_RELATED_VISIBILITY:function(r){return r!=undefined&&r.length>0&&r[0].LeaveRequestType=="2"},SET_RELATED_START_DATE_VISIBILITY:function(r){return r!=undefined&&r.length>0&&r[0].LeaveRequestType=="2"&&r[0].StartDate!=undefined},FORMAT_RELATED_START_DATE:function(r){if(r!=undefined&&r.length>0&&r[0].LeaveRequestType=="2"&&r[0].StartDate!=undefined){try{return hcm.emp.myleaverequests.utils.Formatters.DATE_ODATA_EEEdMMMyyyy(r[0].StartDate)}catch(e){}}return""},FORMAT_RELATED_START_DATE_LONG:function(r){if(r!=undefined&&r.length>0&&r[0].LeaveRequestType=="2"&&r[0].StartDate!=undefined){try{return hcm.emp.myleaverequests.utils.Formatters.DATE_ODATA_EEEdMMMyyyyLong(r[0].StartDate)}catch(e){}}return""},SET_RELATED_END_DATE_VISIBILITY:function(r){return r!=undefined&&r.length>0&&r[0].LeaveRequestType=="2"&&r[0].WorkingDaysDuration!=undefined&&r[0].StartDate!=undefined&&r[0].EndDate!=undefined&&!r[0].EndTime!=undefined&&(hcm.emp.myleaverequests.utils.Formatters.isHalfDayLeave(r[0].WorkingDaysDuration)||r[0].WorkingDaysDuration*1!=1)},FORMAT_RELATED_END_DATE:function(h,r){if(r!=undefined&&r.length>0&&r[0].LeaveRequestType=="2"&&r[0].WorkingDaysDuration!=undefined&&r[0].StartDate!=undefined&&r[0].EndDate!=undefined&&!r[0].EndTime!=undefined){try{if(hcm.emp.myleaverequests.utils.Formatters.isHalfDayLeave(r[0].WorkingDaysDuration)){return hcm.emp.myleaverequests.utils.Formatters.TIME_hhmm(r[0].StartTime)+" "+h+" "+hcm.emp.myleaverequests.utils.Formatters.TIME_hhmm(r[0].EndTime)}if(r[0].WorkingDaysDuration*1!=1){return h+" "+hcm.emp.myleaverequests.utils.Formatters.DATE_ODATA_EEEdMMMyyyy(r[0].EndDate)}}catch(e){}}return""},FORMAT_RELATED_END_DATE_LONG:function(h,r){if(r!=undefined&&r.length>0&&r[0].LeaveRequestType=="2"&&r[0].WorkingDaysDuration!=undefined&&r[0].StartDate!=undefined&&r[0].EndDate!=undefined&&!r[0].EndTime!=undefined){try{if(hcm.emp.myleaverequests.utils.Formatters.isHalfDayLeave(r[0].WorkingDaysDuration)){return hcm.emp.myleaverequests.utils.Formatters.TIME_hhmm(r[0].StartTime)+" "+h+" "+hcm.emp.myleaverequests.utils.Formatters.TIME_hhmm(r[0].EndTime)}if(r[0].WorkingDaysDuration*1!=1){return h+" "+hcm.emp.myleaverequests.utils.Formatters.DATE_ODATA_EEEdMMMyyyyLong(r[0].EndDate)}}catch(e){}}return""},State:function(s){s=s.toLowerCase();switch(s){case"sent":return null;break;case"posted":return"Success";break;case"approved":return"Success";break;case"rejected":return"Error";break;default:return null}},calculateUsed:function(B,a,b){var s=parseFloat(B)+parseFloat(a)+parseFloat(b);s=hcm.emp.myleaverequests.utils.Formatters.BALANCE(s.toString());return s}}}());
